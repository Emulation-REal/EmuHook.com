<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmuHook: Discord Webhook v5.4</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', Courier, monospace;
        }
        body {
            background: #0a0a0a;
            color: #ff1a1a;
            overflow-x: hidden;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="10" fill="%230a0a0a" stroke="%23ff4d4d" stroke-width="3"/><path d="M16 6v20M6 16h20" stroke="%23ff4d4d" stroke-width="3" stroke-linecap="round"/></svg>'), auto;
        }
        .cursor-trail {
            position: fixed;
            width: 8px;
            height: 8px;
            background: #ff4d4d;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
            opacity: 0.7;
            transition: transform 0.05s ease-out, opacity 0.2s;
        }
        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .hologram {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255, 26, 26, 0.1) 2px, rgba(255, 26, 26, 0.1) 4px);
        }
        .container {
            max-width: 900px;
            margin: 50px auto 20px;
            padding: 15px;
            border: 2px solid #ff1a1a;
            box-shadow: 0 0 20px rgba(255, 26, 26, 0.3);
            border-radius: 8px;
        }
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.4em;
            text-shadow: 0 0 10px #ff1a1a;
            animation: neon-pulse 1.5s infinite;
            margin: 0 8px;
        }
        .logo::before {
            content: 'üñ•Ô∏è';
            margin-right: 8px;
            font-size: 1.2em;
        }
        .nav-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.9);
            border-bottom: 2px solid #ff1a1a;
            z-index: 10;
            display: flex;
            align-items: center;
            padding: 5px;
            height: 40px;
        }
        .nav-bar .logo {
            margin-right: auto;
        }
        .nav-bar button {
            background: none;
            border: 2px solid #ff1a1a;
            color: #ff1a1a;
            padding: 5px 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
            font-size: 0.8em;
            margin: 0 3px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .nav-bar button:hover, .nav-bar button.active {
            background: #ff1a1a;
            color: #0a0a0a;
            box-shadow: 0 0 10px #ff1a1a;
        }
        .status-bar {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ff1a1a;
            font-size: 0.7em;
        }
        .user-info {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #ff1a1a;
            font-size: 0.7em;
        }
        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .page.active {
            display: block;
            opacity: 1;
        }
        .category {
            margin: 10px 0;
            border: 1px solid #ff1a1a;
            border-radius: 5px;
            overflow: hidden;
        }
        .category-header {
            background: rgba(26, 26, 26, 0.5);
            padding: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        .category-header:hover {
            background: #ff1a1a;
            color: #0a0a0a;
        }
        .category-content {
            padding: 10px;
            display: none;
        }
        .category-content.active {
            display: block;
        }
        input, select, input[type="file"] {
            background: transparent;
            border: none;
            border-bottom: 2px solid #ff1a1a;
            color: #ff1a1a;
            padding: 6px 5px;
            margin: 5px 0;
            width: 100%;
            font-family: 'Courier New', Courier, monospace;
            transition: all 0.3s;
        }
        input:focus, select:focus, input[type="file"]:focus {
            border-bottom-color: #ff4d4d;
            box-shadow: 0 2px 8px rgba(255, 26, 26, 0.5);
            outline: none;
        }
        select {
            background: rgba(26, 26, 26, 0.5) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10"><path d="M2 3l3 3 3-3" stroke="%23ff1a1a" stroke-width="2" fill="none"/></svg>') no-repeat right 10px center;
            padding-right: 25px;
        }
        button {
            background: none;
            border: 2px solid #ff1a1a;
            color: #ff1a1a;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        button:hover {
            background: #ff1a1a;
            color: #0a0a0a;
            box-shadow: 0 0 10px #ff1a1a;
        }
        .editor-toolbar {
            display: flex;
            gap: 6px;
            margin-bottom: 8px;
        }
        .editor-toolbar button {
            padding: 4px 6px;
            font-size: 0.7em;
        }
        .spinner {
            display: none;
            width: 16px;
            height: 16px;
            border: 2px solid #ff1a1a;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 8px auto;
        }
        .spinner.active {
            display: block;
        }
        #liveStream, #liveStreamSpam, #messageHistory, #logContent {
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid #ff1a1a;
            padding: 8px;
            height: 120px;
            overflow-y: auto;
            margin-top: 8px;
            border-radius: 5px;
            white-space: pre-wrap;
        }
        #liveStream::-webkit-scrollbar, #liveStreamSpam::-webkit-scrollbar, #messageHistory::-webkit-scrollbar, #logContent::-webkit-scrollbar {
            width: 6px;
        }
        #liveStream::-webkit-scrollbar-thumb, #liveStreamSpam::-webkit-scrollbar-thumb, #messageHistory::-webkit-scrollbar-thumb, #logContent::-webkit-scrollbar-thumb {
            background: #ff1a1a;
            border-radius: 3px;
        }
        .saved-webhook {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #ff1a1a;
        }
        .webhook-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #ff1a1a;
            margin: 8px;
        }
        .neon {
            text-shadow: 0 0 5px #ff1a1a;
        }
        .tooltip {
            position: relative;
        }
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(26, 26, 26, 0.9);
            color: #ff1a1a;
            padding: 4px 8px;
            border: 1px solid #ff1a1a;
            border-radius: 4px;
            white-space: nowrap;
            z-index: 10;
        }
        .log-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid #ff1a1a;
            color: #ff1a1a;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            animation: float 2s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .log-toggle:hover {
            background: #ff1a1a;
            color: #0a0a0a;
            box-shadow: 0 0 15px #ff1a1a;
        }
        .log-window {
            position: fixed;
            bottom: 70px;
            right: 20px;
            width: 350px;
            height: 150px;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid #ff1a1a;
            border-radius: 5px;
            display: none;
            z-index: 20;
        }
        .log-window.active {
            display: block;
        }
        .log-header {
            background: rgba(26, 26, 26, 0.5);
            padding: 5px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .log-close {
            background: none;
            border: none;
            color: #ff1a1a;
            cursor: pointer;
            font-size: 1em;
        }
        .log-close:hover {
            color: #0a0a0a;
            background: #ff1a1a;
        }
        .theme-dark-red { --main-color: #ff1a1a; --glow-color: rgba(255, 26, 26, 0.5); }
        .theme-neon-green { --main-color: #00ff00; --glow-color: rgba(0, 255, 0, 0.5); }
        .theme-cyber-blue { --main-color: #00b7eb; --glow-color: rgba(0, 183, 235, 0.5); }
        :root {
            --main-color: #ff1a1a;
            --glow-color: rgba(255, 26, 26, 0.5);
        }
        .container, button, input, select, .nav-bar, .log-toggle, .log-window {
            border-color: var(--main-color);
            color: var(--main-color);
        }
        button:hover, .nav-bar button:hover, .nav-bar button.active, .log-toggle:hover {
            background: var(--main-color);
            box-shadow: 0 0 10px var(--glow-color);
        }
        input:focus, select:focus {
            border-bottom-color: var(--main-color);
            box-shadow: 0 2px 8px var(--glow-color);
        }
        @keyframes neon-pulse {
            0%, 100% { text-shadow: 0 0 5px var(--main-color), 0 0 10px var(--main-color); }
            50% { text-shadow: 0 0 10px var(--main-color), 0 0 20px var(--main-color); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div class="hologram"></div>
    <div class="nav-bar">
        <div class="logo">EmuHook v5.4</div>
        <button onclick="showPage('home')" class="active" data-tooltip="Ctrl+1: Webhook Control">üñ•Ô∏è Home</button>
        <button onclick="showPage('send')" data-tooltip="Ctrl+2: Send Messages">üì§ Send</button>
        <button onclick="showPage('spam')" data-tooltip="Ctrl+3: Spam (Test Only)">‚ö° Spam</button>
        <button onclick="showPage('saved')" data-tooltip="Ctrl+4: Saved Webhooks">üíæ Saved</button>
        <button onclick="showPage('history')" data-tooltip="Ctrl+5: Message History">üìú History</button>
        <button onclick="showPage('settings')" data-tooltip="Ctrl+6: System Config">‚öôÔ∏è Settings</button>
    </div>
    <div class="container">
        <div class="status-bar" id="statusBar"></div>
        <div class="user-info" id="userInfo">Not Logged In</div>
        <div id="home" class="page active">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8h12M8 2v12" stroke="#ff1a1a" stroke-width="2"/></svg> Webhook Input
                </div>
                <div class="category-content active">
                    <input type="text" id="webhookName" placeholder="Webhook Name (Optional)" data-tooltip="Assign a codename">
                    <input type="text" id="webhookUrl" placeholder="Enter Discord Webhook URL" data-tooltip="Insert webhook URL">
                    <button onclick="validateWebhook()" data-tooltip="Verify webhook">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 8l3 3 5-5" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Validate
                    </button>
                    <button onclick="saveWebhook()" data-tooltip="Store webhook">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 4h12v8H2z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Save
                    </button>
                    <button onclick="loginWithDiscord()" data-tooltip="Authenticate via Discord">
                        <svg width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="6" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Login
                    </button>
                    <div class="spinner" id="validateSpinner"></div>
                </div>
            </div>
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 8h8M8 4v8" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Webhook Profile
                </div>
                <div class="category-content" id="webhookProfile"></div>
            </div>
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M3 3h10v10H3z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Bot Control
                </div>
                <div class="category-content">
                    <p class="neon">Bot features require server-side setup. Use webhooks for client-side messaging.</p>
                </div>
            </div>
        </div>
        <div id="send" class="page">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8h12M2 8l4-4M2 8l4 4" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Message Sender
                </div>
                <div class="category-content active">
                    <select id="destination" data-tooltip="Select target">
                        <option value="">Select Webhook</option>
                    </select>
                    <select id="predefinedMessages" data-tooltip="Choose predefined message">
                        <option value="">Custom Message</option>
                        <option value="> [EmuHook] Cyber sequence... {user} at {time}">Cyber Sequence</option>
                        <option value="> [ALERT] Breach by {user}!">Mainframe Breach</option>
                        <option value="> [SYSTEM] Protocols at {time}!">Override Protocols</option>
                    </select>
                    <div class="editor-toolbar">
                        <button onclick="formatText('bold')" data-tooltip="Bold text">ùêÅ</button>
                        <button onclick="formatText('italic')" data-tooltip="Italic text">ùêº</button>
                        <button onclick="formatText('code')" data-tooltip="Code block">üíª</button>
                    </div>
                    <input type="text" id="message" placeholder="Enter message or select predefined" data-tooltip="Craft message">
                    <input type="file" id="attachment" accept="image/*,text/*" data-tooltip="Upload file">
                    <label><input type="checkbox" id="tts" data-tooltip="Enable TTS"> TTS</label>
                    <label><input type="checkbox" id="rainbowMessage" data-tooltip="Rainbow color & wave spacing"> Rainbow Message</label>
                    <input type="text" id="reactions" placeholder="Emojis (e.g., üòÑüëç)" maxlength="10" data-tooltip="Add emojis">
                    <input type="number" id="sendDelay" min="0" step="1" placeholder="Delay (s)" data-tooltip="Schedule delay">
                    <div class="category">
                        <div class="category-header" onclick="toggleCategory(this)">
                            <svg width="16" height="16" viewBox="0 0 16 16"><path d="M3 3h10v10H3z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Embed Options
                        </div>
                        <div class="category-content">
                            <input type="text" id="embedTitle" placeholder="Embed Title" data-tooltip="Set title">
                            <input type="text" id="embedDescription" placeholder="Embed Description" data-tooltip="Set description">
                            <input type="color" id="embedColor" value="#ff1a1a" data-tooltip="Set color (ignored if Rainbow enabled)">
                        </div>
                    </div>
                    <button onclick="sendMessage()" data-tooltip="Send message">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8h12M2 8l4-4M2 8l4 4" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Send
                    </button>
                    <div class="spinner" id="sendSpinner"></div>
                </div>
            </div>
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 4h8v8H4z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Live Stream
                </div>
                <div class="category-content active" id="liveStream"></div>
            </div>
        </div>
        <div id="spam" class="page">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8h12M2 8l4-4M2 8l4 4" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Spam Console
                </div>
                <div class="category-content active">
                    <select id="spamDestination" data-tooltip="Select target">
                        <option value="">Select Webhook</option>
                    </select>
                    <select id="spamPredefinedMessages" data-tooltip="Choose predefined message">
                        <option value="">Custom Message</option>
                        <option value="> [EmuHook] Cyber sequence... {user} at {time}">Cyber Sequence</option>
                        <option value="> [ALERT] Breach by {user}!">Mainframe Breach</option>
                        <option value="> [SYSTEM] Protocols at {time}!">Override Protocols</option>
                    </select>
                    <input type="text" id="spamMessage" placeholder="Enter message or select predefined" data-tooltip="Craft spam message">
                    <input type="number" id="spamCount" min="1" placeholder="Message Count" data-tooltip="Set count">
                    <input type="number" id="spamDelayMin" min="0" step="0.1" placeholder="Min Delay (s)" data-tooltip="Min delay">
                    <input type="number" id="spamDelayMax" min="0" step="0.1" placeholder="Max Delay (s)" data-tooltip="Max delay">
                    <select id="spamPattern" data-tooltip="Select pattern">
                        <option value="linear">Linear</option>
                        <option value="burst">Burst</option>
                        <option value="wave">Wave</option>
                    </select>
                    <input type="text" id="messageVariation" placeholder="Prefix/Suffix (e.g., [x])" data-tooltip="Add variation">
                    <label><input type="checkbox" id="randomizeMessages" data-tooltip="Randomize messages"> Randomize</label>
                    <label><input type="checkbox" id="spamTts" data-tooltip="Enable TTS"> TTS</label>
                    <label><input type="checkbox" id="spamRainbowMessage" data-tooltip="Rainbow color & wave spacing"> Rainbow Message</label>
                    <div id="rateLimitStatus" class="neon">Rate Limit: 100%</div>
                    <button onclick="spamMessages()" data-tooltip="Start spamming">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8h12M2 8l4-4M2 8l4 4" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Start
                    </button>
                    <button onclick="cancelSpam()" data-tooltip="Stop spamming">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 4l8 8M4 12l8-8" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Cancel
                    </button>
                    <div class="spinner" id="spamSpinner"></div>
                </div>
            </div>
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 4h8v8H4z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Live Stream
                </div>
                <div class="category-content active" id="liveStreamSpam"></div>
            </div>
        </div>
        <div id="saved" class="page">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 4h12v8H2z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Saved Webhooks
                </div>
                <div class="category-content active" id="savedWebhooks"></div>
            </div>
        </div>
        <div id="history" class="page">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M8 2v6h4" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Message History
                </div>
                <div class="category-content active" id="messageHistory"></div>
            </div>
        </div>
        <div id="settings" class="page">
            <div class="category">
                <div class="category-header" onclick="toggleCategory(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16"><path d="M8 2v12M2 8h12" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> System Settings
                </div>
                <div class="category-content active">
                    <label>Cursor Trail Intensity:</label>
                    <input type="range" id="cursorTrailIntensity" min="0.1" max="1" step="0.1" value="0.7" data-tooltip="Adjust trail opacity">
                    <label>Cursor Trail Color:</label>
                    <input type="color" id="cursorTrailColor" value="#ff4d4d" data-tooltip="Set trail color">
                    <label>Particle Density:</label>
                    <input type="range" id="particleDensity" min="50" max="200" step="10" value="100" data-tooltip="Adjust particle count">
                    <label>Particle Speed:</label>
                    <input type="range" id="particleSpeed" min="1" max="8" step="1" value="4" data-tooltip="Adjust particle speed">
                    <label>Sound Volume:</label>
                    <input type="range" id="soundVolume" min="0" max="1" step="0.1" value="0.3" data-tooltip="Adjust synth beep volume">
                    <select id="theme" data-tooltip="Select UI theme">
                        <option value="theme-dark-red">Dark Red</option>
                        <option value="theme-neon-green">Neon Green</option>
                        <option value="theme-cyber-blue">Cyber Blue</option>
                    </select>
                    <button onclick="applySettings()" data-tooltip="Apply settings">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 8l3 3 5-5" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Apply
                    </button>
                    <button onclick="clearSavedWebhooks()" data-tooltip="Clear webhooks">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 4l8 8M4 12l8-8" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Clear Webhooks
                    </button>
                    <button onclick="logout()" data-tooltip="Logout">
                        <svg width="16" height="16" viewBox="0 0 16 16"><path d="M8 2v12M2 8h6" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Logout
                    </button>
                </div>
            </div>
        </div>
    </div>
    <button class="log-toggle" onclick="toggleLogWindow()" data-tooltip="View logs">
        <svg width="20" height="20" viewBox="0 0 20 20"><path d="M4 4h12v12H4z" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg>
    </button>
    <div class="log-window" id="logWindow">
        <div class="log-header">
            <span>System Logs</span>
            <button class="log-close" onclick="toggleLogWindow()">X</button>
        </div>
        <div id="logContent"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js"></script>
    <script>
        // Particles.js
        let particleConfig = {
            particles: {
                number: { value: 100 },
                color: { value: '#ff1a1a' },
                shape: { type: 'circle' },
                opacity: { value: 0.7 },
                size: { value: 4 },
                move: { enable: true, speed: 4 }
            }
        };
        particlesJS('particles-js', particleConfig);

        // Synth Sound
        let audioCtx;
        try {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
            console.error('AudioContext initialization failed:', e);
            log('Error: AudioContext not supported in this browser.');
        }

        function playSynthBeep() {
            if (!audioCtx) return log('Error: AudioContext unavailable.');
            try {
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(400, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(document.getElementById('soundVolume')?.value || 0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.2);
            } catch (e) {
                log('Synth sound error: ' + e.message);
            }
        }

        // Cursor Trail
        const trails = [];
        for (let i = 0; i < 12; i++) {
            const trail = document.createElement('div');
            trail.className = 'cursor-trail';
            document.body.appendChild(trail);
            trails.push(trail);
        }
        let trailIndex = 0;
        let lastX = 0, lastY = 0;
        document.addEventListener('mousemove', (e) => {
            const dx = e.clientX - lastX;
            const dy = e.clientY - lastY;
            if (Math.sqrt(dx * dx + dy * dy) > 4) {
                const trail = trails[trailIndex];
                trail.style.left = e.clientX + 'px';
                trail.style.top = e.clientY + 'px';
                trail.style.opacity = document.getElementById('cursorTrailIntensity')?.value || 0.7;
                trail.style.background = document.getElementById('cursorTrailColor')?.value || '#ff4d4d';
                trailIndex = (trailIndex + 1) % trails.length;
                lastX = e.clientX;
                lastY = e.clientY;
            }
        });

        // State
        let webhookUrl = '';
        let isSpamming = false;
        let savedWebhooks = JSON.parse(localStorage.getItem('webhooks') || '[]');
        let messageHistory = JSON.parse(localStorage.getItem('messageHistory') || '[]');
        let user = null;
        let messagesSent = 0;
        const startTime = Date.now();
        const rainbowColors = [0xff0000, 0xff9900, 0xffff00, 0x00ff00, 0x00ffff, 0x0000ff, 0xff00ff];

        function log(message) {
            playSynthBeep();
            const logContent = document.getElementById('logContent');
            const typed = new Typed('#logContent', {
                strings: [`> [${new Date().toLocaleTimeString()}] ${message}\n${logContent.textContent}`],
                typeSpeed: 20,
                showCursor: false,
                onComplete: () => logContent.scrollTop = logContent.scrollHeight
            });
        }

        function updateLiveStream(message, streamId = 'liveStream') {
            playSynthBeep();
            const stream = document.getElementById(streamId);
            const entry = document.createElement('div');
            entry.textContent = `> [${new Date().toLocaleTimeString()}] ${user ? user.username : 'EmuHook'}: ${message}`;
            stream.appendChild(entry);
            stream.scrollTop = stream.scrollHeight;
            messageHistory.push({ time: new Date().toLocaleTimeString(), message, sender: user ? user.username : 'EmuHook' });
            localStorage.setItem('messageHistory', JSON.stringify(messageHistory));
            updateMessageHistory();
            messagesSent++;
            updateStatusBar();
        }

        function updateStatusBar() {
            const uptime = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('statusBar').textContent = `Uptime: ${uptime}s | Messages: ${messagesSent} | Webhooks: ${savedWebhooks.length}`;
        }

        function showPage(pageId) {
            playSynthBeep();
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-bar button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelector(`button[onclick="showPage('${pageId}')"]`).classList.add('active');
        }

        function toggleCategory(header) {
            playSynthBeep();
            header.nextElementSibling.classList.toggle('active');
        }

        function toggleLogWindow() {
            playSynthBeep();
            document.getElementById('logWindow').classList.toggle('active');
        }

        async function validateWebhook() {
            playSynthBeep();
            const url = document.getElementById('webhookUrl').value.trim();
            if (!url) return log('Error: Webhook URL required.');
            document.getElementById('validateSpinner').classList.add('active');
            try {
                const response = await fetch(url, { method: 'GET', headers: { 'Accept': 'application/json' } });
                document.getElementById('validateSpinner').classList.remove('active');
                if (response.ok) {
                    webhookUrl = url;
                    log('Webhook validated.');
                    fetchWebhookProfile(url);
                    updateDestinationSelects();
                } else {
                    log(`Invalid webhook URL: ${response.status}`);
                }
            } catch (error) {
                document.getElementById('validateSpinner').classList.remove('active');
                log('Validation error: ' + error.message);
            }
        }

        async function fetchWebhookProfile(url) {
            try {
                const response = await fetch(url, { headers: { 'Accept': 'application/json' } });
                const data = await response.json();
                const avatarUrl = data.avatar ? `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png?size=64` : null;
                document.getElementById('webhookProfile').innerHTML = `
                    ${avatarUrl ? `<img src="${avatarUrl}" class="webhook-avatar">` : ''}
                    <p class="neon">Webhook: ${data.name || 'N/A'}</p>
                    <p class="neon">Channel: ${data.channel_id || 'N/A'}</p>
                `;
            } catch (error) {
                log('Profile fetch error: ' + error.message);
            }
        }

        function saveWebhook() {
            playSynthBeep();
            const url = document.getElementById('webhookUrl').value.trim();
            const name = document.getElementById('webhookName').value.trim() || `Webhook ${savedWebhooks.length + 1}`;
            if (!webhookUrl) return log('Error: No valid webhook.');
            if (!savedWebhooks.some(w => w.url === webhookUrl)) {
                savedWebhooks.push({ name, url: webhookUrl });
                localStorage.setItem('webhooks', JSON.stringify(savedWebhooks));
                log(`Webhook saved: ${name}`);
                updateSavedWebhooks();
                updateDestinationSelects();
            } else {
                log('Webhook already saved.');
            }
        }

        function updateSavedWebhooks() {
            const savedDiv = document.getElementById('savedWebhooks');
            savedDiv.innerHTML = '';
            savedWebhooks.forEach(({ name, url }) => {
                const div = document.createElement('div');
                div.className = 'saved-webhook';
                div.innerHTML = `<span>${name}: ${url}</span>
                    <button onclick="loadWebhook('${url}')"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 8h8M8 4v8" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Load</button>
                    <button onclick="deleteWebhook('${url}')"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M4 4l8 8M4 12l8-8" stroke="#ff1a1a" stroke-width="2" fill="none"/></svg> Delete</button>`;
                savedDiv.appendChild(div);
            });
        }

        function loadWebhook(url) {
            playSynthBeep();
            webhookUrl = url;
            document.getElementById('webhookUrl').value = url;
            log('Webhook loaded: ' + url);
            fetchWebhookProfile(url);
            updateDestinationSelects();
        }

        function deleteWebhook(url) {
            playSynthBeep();
            savedWebhooks = savedWebhooks.filter(w => w.url !== url);
            localStorage.setItem('webhooks', JSON.stringify(savedWebhooks));
            log('Webhook deleted: ' + url);
            updateSavedWebhooks();
            updateDestinationSelects();
        }

        function clearSavedWebhooks() {
            playSynthBeep();
            savedWebhooks = [];
            localStorage.setItem('webhooks', JSON.stringify(savedWebhooks));
            log('Webhooks cleared.');
            updateSavedWebhooks();
            updateDestinationSelects();
        }

        function updateMessageHistory() {
            const historyDiv = document.getElementById('messageHistory');
            historyDiv.innerHTML = '';
            messageHistory.forEach(({ time, message, sender }) => {
                const div = document.createElement('div');
                div.textContent = `> [${time}] ${sender}: ${message}`;
                historyDiv.appendChild(div);
            });
        }

        function updateDestinationSelects() {
            const selects = [document.getElementById('destination'), document.getElementById('spamDestination')];
            selects.forEach(select => {
                select.innerHTML = '<option value="">Select Webhook</option>';
                savedWebhooks.forEach(({ name, url }) => {
                    const option = document.createElement('option');
                    option.value = `webhook:${url}`;
                    option.textContent = `Webhook: ${name}`;
                    select.appendChild(option);
                });
            });
        }

        function loginWithDiscord() {
            playSynthBeep();
            log('Discord login not implemented in client-side demo.');
        }

        function formatText(type) {
            playSynthBeep();
            const input = document.getElementById('message');
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const selected = input.value.substring(start, end);
            if (!selected) return;
            const formatted = type === 'bold' ? `**${selected}**` : type === 'italic' ? `*${selected}*` : `\`\`\`${selected}\`\`\``;
            input.value = input.value.substring(0, start) + formatted + input.value.substring(end);
            log(`Applied ${type} formatting.`);
        }

        function applyWaveSpacing(message, index) {
            const indent = Math.round(Math.sin(index / 2) * 10);
            return ' '.repeat(Math.max(0, indent)) + message;
        }

        async function sendMessage() {
            playSynthBeep();
            const destination = document.getElementById('destination').value;
            let message = document.getElementById('predefinedMessages').value || document.getElementById('message').value;
            const tts = document.getElementById('tts').checked;
            const rainbow = document.getElementById('rainbowMessage').checked;
            const reactions = document.getElementById('reactions').value.split('').filter(c => c.match(/\p{Emoji}/u)).slice(0, 5);
            const delay = parseInt(document.getElementById('sendDelay').value) || 0;
            const file = document.getElementById('attachment').files[0];
            const embed = {
                title: document.getElementById('embedTitle').value || undefined,
                description: document.getElementById('embedDescription').value || undefined,
                color: rainbow ? rainbowColors[Math.floor(Math.random() * rainbowColors.length)] : parseInt(document.getElementById('embedColor').value.replace('#', ''), 16) || undefined
            };

            if (!destination || (!message && !file && !embed.title && !embed.description)) return log('Error: Select destination and provide content.');

            message = message.replace('{user}', user ? user.username : 'EmuHook').replace('{time}', new Date().toLocaleTimeString());
            if (rainbow) message = applyWaveSpacing(message, messagesSent);

            document.getElementById('sendSpinner').classList.add('active');

            try {
                if (destination.startsWith('webhook:')) {
                    const url = destination.replace('webhook:', '');
                    const payload = {
                        content: message,
                        tts: tts,
                        embeds: embed.title || embed.description ? [embed] : undefined
                    };
                    const formData = new FormData();
                    formData.append('payload_json', JSON.stringify(payload));
                    if (file) formData.append('file', file);
                    await new Promise(resolve => setTimeout(resolve, delay * 1000));
                    const response = await fetch(url, {
                        method: 'POST',
                        body: formData,
                        headers: { 'Accept': 'application/json' }
                    });
                    if (response.ok) {
                        log('Message sent via webhook.');
                        updateLiveStream(message);
                        if (reactions.length) log('Reactions not supported for webhooks.');
                    } else {
                        log(`Webhook send error: ${response.status} ${response.statusText}`);
                    }
                }
            } catch (error) {
                log('Send error: ' + error.message);
            } finally {
                document.getElementById('sendSpinner').classList.remove('active');
            }
        }

        async function spamMessages() {
            if (isSpamming) return log('Spam already running.');
            playSynthBeep();
            const destination = document.getElementById('spamDestination').value;
            let message = document.getElementById('spamPredefinedMessages').value || document.getElementById('spamMessage').value;
            const count = parseInt(document.getElementById('spamCount').value) || 1;
            const minDelay = parseFloat(document.getElementById('spamDelayMin').value) || 0;
            const maxDelay = parseFloat(document.getElementById('spamDelayMax').value) || minDelay;
            const pattern = document.getElementById('spamPattern').value;
            const variation = document.getElementById('messageVariation').value;
            const randomize = document.getElementById('randomizeMessages').checked;
            const tts = document.getElementById('spamTts').checked;
            const rainbow = document.getElementById('spamRainbowMessage').checked;
            const predefined = document.getElementById('spamPredefinedMessages').options;
            if (!destination || (!message && !randomize)) return log('Error: Select destination and provide content.');

            isSpamming = true;
            document.getElementById('spamSpinner').classList.add('active');
            let sent = 0;

            const sendSingle = async () => {
                const msg = randomize ? predefined[Math.floor(Math.random() * predefined.length)].value : message;
                const variedMsg = variation ? `${variation.replace('[x]', Math.floor(Math.random() * 100))}${msg}${variation.replace('[x]', Math.floor(Math.random() * 100))}` : msg.replace('{user}', user ? user.username : 'EmuHook').replace('{time}', new Date().toLocaleTimeString());
                const finalMsg = rainbow ? applyWaveSpacing(variedMsg, sent) : variedMsg;
                if (destination.startsWith('webhook:')) {
                    const url = destination.replace('webhook:', '');
                    const payload = {
                        content: finalMsg,
                        tts: tts,
                        embeds: rainbow ? [{ color: rainbowColors[sent % rainbowColors.length] }] : undefined
                    };
                    const response = await fetch(url, {
                        method: 'POST',
                        body: JSON.stringify(payload),
                        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }
                    });
                    if (response.ok) {
                        updateLiveStream(finalMsg, 'liveStreamSpam');
                    } else {
                        log(`Webhook spam error: ${response.status} ${response.statusText}`);
                    }
                }
                sent++;
                document.getElementById('rateLimitStatus').textContent = `Rate Limit: ${Math.round((1 - sent / count) * 100)}%`;
                log(`Spam sent ${sent}/${count}`);
            };

            try {
                if (pattern === 'linear') {
                    for (let i = 0; i < count && isSpamming; i++) {
                        await sendSingle();
                        await new Promise(resolve => setTimeout(resolve, Math.random() * (maxDelay - minDelay) + minDelay * 1000));
                    }
                } else if (pattern === 'burst') {
                    for (let i = 0; i < count && isSpamming; i += 5) {
                        await Promise.all(Array(Math.min(5, count - i)).fill().map(() => sendSingle()));
                        await new Promise(resolve => setTimeout(resolve, Math.random() * (maxDelay - minDelay) + minDelay * 1000));
                    }
                } else if (pattern === 'wave') {
                    for (let i = 0; i < count && isSpamming; i++) {
                        await sendSingle();
                        const waveDelay = (Math.sin(i / 5) * (maxDelay - minDelay) + minDelay) * 1000;
                        await new Promise(resolve => setTimeout(resolve, waveDelay));
                    }
                }
            } catch (error) {
                log('Spam error: ' + error.message);
            } finally {
                isSpamming = false;
                document.getElementById('spamSpinner').classList.remove('active');
                log('Spam sequence completed.');
            }
        }

        function cancelSpam() {
            playSynthBeep();
            isSpamming = false;
            document.getElementById('spamSpinner').classList.remove('active');
            log('Spam sequence cancelled.');
        }

        function applySettings() {
            playSynthBeep();
            const theme = document.getElementById('theme').value;
            document.body.className = theme;
            particleConfig.particles.color.value = theme === 'theme-neon-green' ? '#00ff00' : theme === 'theme-cyber-blue' ? '#00b7eb' : '#ff1a1a';
            particleConfig.particles.number.value = parseInt(document.getElementById('particleDensity').value);
            particleConfig.particles.move.speed = parseInt(document.getElementById('particleSpeed').value);
            particlesJS('particles-js', particleConfig);
            log('Settings applied.');
        }

        function logout() {
            playSynthBeep();
            user = null;
            document.getElementById('userInfo').textContent = 'Not Logged In';
            log('Logged out.');
        }

        // Initialize
        updateSavedWebhooks();
        updateMessageHistory();
        updateDestinationSelects();
        updateStatusBar();
        setInterval(updateStatusBar, 1000);
    </script>
</body>
</html>
